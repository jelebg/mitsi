<!DOCTYPE html>
<html lang="en" >
<head>
<title>Mitsi</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="icon" type="image/png" href="img/favicon.png" />

<link rel="stylesheet" href="bootstrap-3.3.5-dist/css/bootstrap.min.css"/>
<!--  link rel="stylesheet" href="bootstrap-3.3.5-dist/css/bootstrap-theme.min.css"/ -->
<link rel="stylesheet" href="ui-layout-0.0.0/ui-layout.css"/>

<script src="angularjs-1.4.3/angular.js"></script>
<!-- script src="angularjs-1.4.3/angular-route.js"></script -->
<script src="ui-bootstrap-0.13.3/ui-bootstrap-tpls-0.13.3.js"></script>
<script src="ui-layout-master/ui-layout.js"></script>

<script src="sourcesCtrl.js"></script>

</head>

<body data-ng-app="mitsiApp">
<div  ng-controller="sourcesCtrl">
<!--a href="" class="btn btn-info" ng-click="init()">init</a><br -->
>{{ tutu }}<  



	<span dropdown on-toggle="toggled(open)">
      <a href id="simple-dropdown" dropdown-toggle>
        Click me for a dropdown, yo!
      </a>
      <ul class="dropdown-menu" aria-labelledby="simple-dropdown">
        <li ><a href>tutu</a></li>
        <li ><a href>titi</a></li>
        <li ><a href>toto</a></li>
      </ul>
    </span>


<br/>
	<div class="form-group has-feedback">
		<!--i class="glyphicon glyphicon-filter form-control-feedback"></i-->
		<a href="" style="pointer-events: all;" class="glyphicon glyphicon-remove form-control-feedback filter-glyphicon" ng-click="searchSource=null; $event.stopPropagation();"></a>
		<input type="text" ng-model="searchSource" class="form-control" placeholder="Search datasources here..."/>
	</div>
	<!--ul class="mitsi-source-list" >
		<li ng-repeat="s in datasources" title="{{s.description}}">
			{{ s.name }}
		</li>
	</ul -->
	
	<accordion close-others="true">
		<accordion-group 
			ng-repeat="s in datasources | orderBy:'name'" 
			is-open="s.accordionOpened" 
			is-disabled="false" 
			title="{{s.description}}" 
			ng-hide="isSourceExcludedByFilter(s)">
		  <accordion-heading >
		  	<i class="glyphicon glyphicon-exclamation-sign datasource-error"
		  		ng-if="s.errorMessage != null"></i>
            <span class="datasource-accordion-{{s.connected}}"  
            	ng-click="selectSource(s)"
            >{{s.name}}</span>
            <!--  popover="test popover" 
            	popover-title="test popover title"
            	popover-trigger="click"
            	popover-placement="right" -->
	        <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': s.accordionOpened, 'glyphicon-chevron-right': !s.accordionOpened}"></i>
            <a href=""  ng-click="connect(s); $event.stopPropagation();">
	            <i class="pull-right glyphicon" style="margin-right:5px" ng-class="{'glyphicon-remove-circle': !s.connected, 'glyphicon-ok-circle': s.connected}"></i>
            </a>
             
            <a href=""  ng-click="refresh(s); $event.stopPropagation();">
	            <i class="pull-right glyphicon glyphicon-refresh" style="margin-right:5px" ></i>
            </a>
            <br/>
            <span class="sourceTags">{{ s.tags.join(", ") }}</span><br ng-if="s.errorMessage!=null"/>
            <!--alert type="danger" 
            	popover="les details" 
            	popover-trigger="mouseenter"
            	popover-placement="bottom"
            	>hello</alert-->
           </accordion-heading>
            {{ s.description }}
            <!--table style="width:100%"><tr><td >schema : {{ s.currentSchema.name }}</td>
            <td ><input type="text" 
            	ng-model="selected" 
            	typeahead="schema.name for schema in s.schemas | limitTo:20 | orderBy:'schema.name' " 
            	class="form-control"
            	placeholder="change current schema here"/></td></tr></table-->
            <br/>
		    <!-- div class="btn-group" dropdown style="width:100%">
		      <button id="single-button" type="button" class="btn btn-default" dropdown-toggle style="width:100%">
		        {{ s.currentSchema.name }} <span class="caret"></span>
		      </button>            
		      <ul class="dropdown-menu" role="menu" aria-labelledby="single-button">
           	    <li role="menuitem" ng-repeat="schema in s.schemas | orderBy:'name' ">
           	  	  <a href="#">{{ schema.name }}</a>
           	    </li>
              </ul>
	        </div -->
	        <table style="width:100%"><tr><td style="width:80px">schema : </td><td><select name="currentSchemaSelect" style="width:100%">
	        	<option ng-repeat="schema in s.schemas | orderBy:'name' " ng-selected="schema.current">
					{{ schema.name }}
           	    </option>
              </ul>
	        </select></td></tr></table>
            <br/>
           <alert type="danger" 
            	popover="{{ s.errorDetails }}" 
            	popover-trigger="mouseenter"
            	popover-placement="bottom" 
            	close="s.errorMessage=null; s.errorDetails=null; "
            	dismiss-on-timeout="10000"
            	ng-if="s.errorMessage!=null"
            	>{{ s.errorMessage }}
            </alert>
	      	<table style="width:100%;margin-bottom:10px;"><td style="width:150px">
		        <a href="" class="btn btn-default"><img src="img/table.png"/></a>
		        <a href="" class="btn btn-default"><img src="img/view.png"/></a>
		        <a href="" class="btn btn-default"><img src="img/matview.png"/></a>
		    </td><td>
				<span dropdown on-toggle="toggled(open)" >
			      	<div class="form-group has-feedback" style="margin-bottom:0px;margin-left:5px;">
						<a href="" style="pointer-events: all;" class="glyphicon glyphicon-remove form-control-feedback filter-glyphicon" ng-click="s.searchObject=null; $event.stopPropagation();"></a>
						<a href="" dropdown-toggle style="pointer-events: all;margin-right:20px;" class="glyphicon glyphicon-option-horizontal form-control-feedback filter-glyphicon"></a>
						
						<input type="text" ng-model="s.searchObject" class="form-control" placeholder="Search tables here..."/>
					</div>
				    <ul class="dropdown-menu" >
				        <li ><a href="" ng-click="s.filter.tableName=!s.filter.tableName; $event.stopPropagation();">
				        	<i class="glyphicon glyphicon-ok" ng-class="{'mitsi-grey':!s.filter.tableName}"></i>
				        	filter tables names
				        </a></li>
				        <li ><a href="" ng-click="s.filter.columnName=!s.filter.columnName; $event.stopPropagation();">
				        	<i class="glyphicon glyphicon-ok" ng-class="{'mitsi-grey':!s.filter.columnName}"></i>
				        	filter columns names
				        </a></li>
				        <li ><a href="" ng-click="s.filter.indexName=!s.filter.indexName; $event.stopPropagation();">
				        	<i class="glyphicon glyphicon-ok" ng-class="{'mitsi-grey':!s.filter.indexName}"></i> 
				        	filter indexes names
				        </a></li>
				        <li ><a href="" ng-click="s.filter.constraintName=!s.filter.constraintName; $event.stopPropagation();">
				        	<i class="glyphicon glyphicon-ok" ng-class="{'mitsi-grey':!s.filter.constraintName}"></i>
				        	filter constraints names
				        </a></li>
				    </ul>
			   </span>
			</td></table>
			      
	      	<accordion close-others="false">
				<accordion-group 
					ng-repeat="o in s.objects | orderBy:'id.name'" 
					is-open="o.accordionOpened" 
					is-disabled="false" 
					title="{{o.description}}"
					ng-hide="isObjectExcludedByFilter(o.id.name, s)">
				  <accordion-heading>
			        <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': o.accordionOpened, 'glyphicon-chevron-right': !o.accordionOpened}"></i>
			        <i class="pull-right glyphicon glyphicon-pushpin" ng-class="{'database-object-pined': o.accordionPined, 'database-object-unpined': !o.accordionPined }"></i>
				        <img src="img/{{ o.id.type=='table' ? 'table' : o.id.type=='matview' ? 'matview' : o.id.type=='view' ? 'view' : '' }}.png"/>
				  	<span ng-click="selectObject(s, o)">
				  		{{ o.id.name }}
				  	</span>
			      </accordion-heading>
			<!--ul>
				<li ng-repeat="o in s.objects">
							{{ o.id.name }} -->
					<ul class="mitsi-columns-list" >
						<li ng-repeat="c in o.columns" title="{{c.description}}" >
							{{ c.name }}
						</li>
					</ul>
				<!--/li>
			</ul-->
			    </accordion-group>
			</accordion>
	    </accordion-group>
	</accordion>
	
	end
</div>
</body>
</html>